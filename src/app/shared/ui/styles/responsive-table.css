/**
 * DESCRIPCIÓN:
 * Componente CSS portable que transforma tablas HTML en tarjetas (cards)
 * responsivas cuando el viewport es menor al breakpoint definido.
 * 
 * COMPATIBILIDAD:
 * ✓ HTML/CSS/JavaScript vanilla
 * ✓ Angular (2+)
 * ✓ ASP.NET MVC (Razor/CSHTML)
 * ✓ React, Vue, y cualquier framework que use HTML estándar
 * 
 * TOKENS:
 * Los tokens --rtc-* son alias de --table-* definidos en:
 * tokens/table-tokens.css (Single Source of Truth)
 */

/* ============================================
   TOKENS: Importados desde archivo centralizado
   Los tokens --rtc-* son alias de --table-*
   Ver: tokens/table-tokens.css
   ============================================ */
@import url('./tokens/table-tokens.css');

/* Tokens adicionales específicos de responsive-table (no compartidos) */
:root {
    --rtc-row-gap: 0;
    --rtc-breakpoint: 768px;
}

/* ============================================
   BASE TABLE STYLES (DESKTOP)
   ============================================ */
.rtc-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    /* Removed spacing to fix sticky gaps */
    font-family: var(--rtc-font-family);
    font-size: var(--rtc-font-size-base);
    color: var(--rtc-color-text);
}

/* === Header === */
.rtc-header {
    display: table-header-group;
    z-index: 10;
}

/* Sticky Header Implementation */
.rtc-header th {
    position: sticky;
    top: 0;
    z-index: 20;
    /* Ensure header stays above rows */
    padding: var(--rtc-cell-padding);
    color: var(--rtc-header-color);
    font-size: var(--rtc-font-size-header);
    font-weight: var(--rtc-font-weight-header);
    text-align: left;
    text-transform: uppercase;
    letter-spacing: 0.06em;

    /* Fondo */
    background: var(--rtc-header-bg);

    /* Borde "Cápsula" (Tokenized) */
    border-top: var(--rtc-header-border-width) var(--rtc-header-border-style) var(--rtc-header-border-color);
    border-bottom: var(--rtc-header-border-width) var(--rtc-header-border-style) var(--rtc-header-border-color);
    border-left: none;
    border-right: none;

    /* Box shadow sutil */
    box-shadow: var(--rtc-header-shadow);
}

.rtc-header th:first-child {
    border-left: var(--rtc-header-border-width) var(--rtc-header-border-style) var(--rtc-header-border-color);
    border-top-left-radius: var(--rtc-header-radius);
    border-bottom-left-radius: var(--rtc-header-radius);
}

.rtc-header th:last-child {
    border-right: var(--rtc-header-border-width) var(--rtc-header-border-style) var(--rtc-header-border-color);
    border-top-right-radius: var(--rtc-header-radius);
    border-bottom-right-radius: var(--rtc-header-radius);
}

/* Primary Color Border Indication (Removed conflicting override) */

/* === Body === */
.rtc-body {
    display: table-row-group;
}

/* === Rows === */
.rtc-row {
    position: relative;
    background-color: var(--rtc-color-background);
    transition:
        background-color var(--rtc-transition-duration) var(--rtc-transition-timing),
        box-shadow var(--rtc-transition-duration) var(--rtc-transition-timing),
        transform var(--rtc-transition-duration) var(--rtc-transition-timing);
    border-bottom: 1px solid var(--rtc-color-border-light);
}

/* Zebra stripes - Filas alternadas */
.rtc-body .rtc-row:nth-child(odd) {
    background-color: var(--rtc-color-stripe);
}

/* Hover effect - Elevación */
.rtc-row:hover {
    background-color: var(--rtc-color-row-hover);
    box-shadow: var(--rtc-row-hover-shadow);
    transform: var(--rtc-row-hover-transform);
    z-index: 1;
}

/* === Cells === */
.rtc-table td {
    padding: var(--rtc-cell-padding);
    border: none;
    border-bottom: 1px solid var(--rtc-color-border-light);
    /* Line divider instead of shadow */
    vertical-align: middle;
}

/* Last row border removal */
.rtc-row:last-child td {
    border-bottom: none;
}

/* ============================================
   MOBILE STYLES (CARDS)
   ============================================ */
@media screen and (max-width: 768px) {

    /* Hide header on mobile - FORCE HIDDEN */
    .rtc-header,
    .rtc-header th {
        display: none !important;
    }

    /* Body as block container */
    .rtc-body {
        display: block;
        width: 100%;
    }

    /* Row becomes a card - Compact Sizing */
    .rtc-row {
        display: flex !important;
        flex-direction: column !important;
        position: relative;
        width: 100%;
        box-sizing: border-box;
        background-color: var(--rtc-color-background);
        border: 1px solid var(--rtc-color-border);
        border-radius: var(--rtc-border-radius);
        padding: var(--space-4) !important;
        margin-bottom: var(--space-3) !important;
        box-shadow: var(--rtc-shadow-card);
        min-height: 200px;
    }

    .rtc-row:hover {
        transform: none;
        background-color: var(--rtc-color-background) !important;
        box-shadow: var(--rtc-shadow-card) !important;
        z-index: auto;
    }

    /* Cell Styles - Compact Layout */
    .rtc-table td {
        display: flex !important;
        flex-direction: row !important;
        align-items: flex-start !important;
        justify-content: flex-start !important;
        border: none !important;
        border-bottom: 1px solid var(--rtc-color-border-light) !important;
        border-radius: 0 !important;
        padding: var(--space-2) 0 !important;
        font-size: var(--rtc-font-size-mobile);
        min-height: auto !important;
    }

    .rtc-table td:last-child {
        border-bottom: none !important;
        padding-bottom: 0 !important;
    }

    /* Label Styles - Cleaner Look */
    .rtc-table td[data-label]::before {
        content: attr(data-label);
        display: block !important;
        font-weight: var(--rtc-font-weight-label);
        color: var(--rtc-color-label);
        font-size: var(--text-sm);
        width: 40%;
        max-width: 140px;
        flex-shrink: 0;
        text-align: left;
        padding-right: var(--space-2);
    }

    /* Value Styles - Left Aligned */
    .rtc-table td[data-label]>*,
    .rtc-table td[data-label]::after {
        flex: 1;
        text-align: left;
        word-break: break-word;
    }

    /* Legacy: data-title support */
    .rtc-table td[data-title]:not([data-label])::before {
        content: attr(data-title);
        display: block !important;
        font-weight: var(--rtc-font-weight-label);
        color: var(--rtc-color-label);
        font-size: var(--text-sm);
        width: 40%;
        max-width: 140px;
        flex-shrink: 0;
        text-align: left;
        padding-right: var(--space-2);
    }

    /* Acciones con label visible */
    .rtc-actions {
        flex-direction: row !important;
        justify-content: flex-end !important;
        padding-top: var(--space-3) !important;
        margin-top: var(--space-2) !important;
        border-top: 1px solid var(--rtc-color-border) !important;
        border-bottom: none !important;
    }
}

/* ============================================
   UTILITY CLASSES
   ============================================ */

/* === Visibility Utilities === */

/* Show only on mobile */
.rtc-mobile-only {
    display: none !important;
}

@media screen and (max-width: 768px) {
    .rtc-mobile-only {
        display: flex !important;
    }
}

/* Show only on desktop */
.rtc-desktop-only {
    display: table-cell;
}

@media screen and (max-width: 768px) {
    .rtc-desktop-only {
        display: none !important;
    }
}

/* === Actions Container === */
.rtc-actions {
    display: flex;
    gap: var(--space-2);
    align-items: center;
    justify-content: center;
}

@media screen and (max-width: 768px) {
    .rtc-actions {
        justify-content: center;
        padding-top: var(--space-3);
        margin-top: var(--space-2);
        border-top: 1px solid var(--rtc-color-border);
    }
}

/* === Text Alignment Utilities === */
.rtc-text-center,
.rtc-table td.rtc-text-center,
.rtc-table th.rtc-text-center {
    text-align: center;
}

.rtc-text-left {
    text-align: left;
}

.rtc-text-right {
    text-align: right;
}

@media screen and (max-width: 768px) {

    /* RESET MÓVIL: Forzar todo a la izquierda en vista de tarjetas */
    .rtc-text-center,
    .rtc-text-right,
    .rtc-text-left {
        text-align: left !important;
    }
}

/* NOTA: Para badges de estado, usar ChipComponent de la UI Library */

/* ============================================
   ACCESSIBILITY
   ============================================ */

/* Focus styles for interactive elements */
.rtc-table a:focus,
.rtc-table button:focus {
    outline: 2px solid var(--rtc-color-primary);
    outline-offset: 2px;
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
    .rtc-row {
        transition: none;
    }
}

/* ============================================
   GLOBAL LOADING STATES - DARK MODE
   ============================================ */

/* Dark Mode Spinner - HIGH VISIBILITY */
.dark .spinner,
html.dark .spinner,
[data-theme="dark"] .spinner {
    border-color: var(--border-color-strong) !important;
    border-top-color: var(--primary-color-lighter) !important;
}

/* Dark Mode Skeleton - Using CSS Variables */
.dark .skeleton,
html.dark .skeleton,
[data-theme="dark"] .skeleton {
    --skeleton-base: var(--gray-400);
    --skeleton-highlight: var(--gray-300);
}

/* Loading container background for dark mode */
.dark .loading-container,
html.dark .loading-container,
[data-theme="dark"] .loading-container {
    background: transparent;
}